<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../polymer/lib/elements/dom-repeat.html">
<link rel="import" href="../polymer/lib/elements/dom-if.html">

<dom-module id="random-list">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <template is="dom-if" if="[[display]]">
      <p>Source: [[source.length]] elements</p>
      <ul>
        <template is="dom-repeat" items="[[source]]">
            <li>[[item]]</li>
        </template>
      </ul>
      <p>List: [[list.length]] elements</p>
      <ul>
        <template is="dom-repeat" items="[[list]]">
            <li>[[item]]</li>
        </template>
      </ul>
      <p>Rest: [[rest.length]] elements</p>
      <ul>
        <template is="dom-repeat" items="[[rest]]">
            <li>[[item]]</li>
        </template>
      </ul>
      </template>
  </template>

  <script>
    /**
     * `random-list`
     * Returns the subset of a list of x elements from a larger source list.
     *
     * @customElement
     * @polymer
     * @demo demo/index.html
     */
    class RandomList extends Polymer.Element {
      static get is() { return 'random-list'; }
      static get properties() {
        return {
          display: {
            type: Boolean,
            value: false,
          },
          source: {
            type: Array,
            value: [],
          },
          max: {
            type: Number,
            value: 1,
          },
          list: {
            type: Array,
            value: [],
          },
          rest: {
            type: Array,
            value: [],
          },
        };
      }

      ready() {
        super.ready();

        this.display = this.display && this.source && this.source.length > 0;

        if (!this.source || this.source.length === 0) {
          return;
        }

        if (this.max === 0) {
          this.list = this.source;
          this.rest = [];
          return;
        }

        // Process the source.
        const _source = this.source
          .slice(0)
          .map(item => {
            if (typeof item === 'object') {
              return JSON.stringify(item);
            }
            return item;
          });

        // Update main source before any random picking.
        this.source = _source.slice(0);

        // Start with an empty list that will be output.
        const _list = [];

        // Pick a random element.
        const _selection = _source[Math.floor(Math.random() * (_source.length - 1))];

        // Add the random element to the list that will be output.
        _list.push(_selection);

        // Remove the random element from the source that will be output in the rest.
        _source.splice(_source.indexOf(_selection), 1);

        // Output.
        this.list = _list;
        this.rest = _source;
      }
    }

    window.customElements.define(RandomList.is, RandomList);
  </script>
</dom-module>

<!--
const adjectives = [ 'Amazing', 'Excellent', 'Awesome', 'Sensational', 'Unbelievable', 'Stupendous', 'Marvellous', 'Exciting', 'Spectacular', 'Phenomenal', 'Prodigious', 'Wondrous', 'Magical' ];
const randomTitle = () => {
  const selection = adjectives[Math.floor(Math.random() * (adjectives.length - 1))];
  adjectives.splice(adjectives.indexOf(selection), 1);
  return `${selection} Loan`;
};
-->
